<?xml version='1.0' encoding='UTF-8'?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" version="2.1"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:af="http://xmlns.oracle.com/adf/faces/rich"
          xmlns:f="http://java.sun.com/jsf/core">
  <c:set var="viewBundle" value="#{adfBundle['dms_v']}"/>
  <af:panelStretchLayout id="psl1" startWidth="0px" topHeight="50px">
    <f:facet name="bottom">
      <af:panelGroupLayout layout="scroll"
                           xmlns:af="http://xmlns.oracle.com/adf/faces/rich"
                           id="pgl4">
        <af:popup id="p2" autoCancel="disabled" childCreation="deferred"
                  binding="#{viewScope.BPCostBean.dataExportWnd}">
          <af:panelWindow id="pw2" title="#{viewBundle['dms.dgpt.dataExport']}">
            <af:panelGridLayout id="pgl5">
              <af:gridRow marginTop="5px" height="auto" id="gr2">
                <af:gridCell marginStart="5px" width="auto" id="gc6"
                             inlineStyle="padding-top:5px">
                  <af:outputText value="#{viewBundle['dms.dgpt.excel.format']}"
                                 id="ot10"/>
                </af:gridCell>
                <af:gridCell marginStart="5px" marginEnd="5px" width="auto"
                             id="gc9">
                 <!-- <af:selectBooleanRadio text="#{viewBundle['dms.dgpt.excel.03format']}"
                                         id="sbr3" group="excelFormat1"
                                         simple="true"/>-->
                  <af:selectBooleanRadio text="#{viewBundle['dms.dgpt.excel.07format']}"
                                         id="sbr4" group="excelFormat1"
                                         simple="true" autoSubmit="true"
                                         value="#{viewScope.BPCostBean.isXlsx}"/>
                </af:gridCell>
              </af:gridRow>
              <af:gridRow marginTop="5px" marginBottom="5px" height="auto"
                          id="gr1">
                <af:gridCell marginStart="5px" width="auto" columnSpan="2"
                             halign="center" id="gc8"
                             inlineStyle="margin-top:5px">
                  <af:commandButton text="#{viewBundle['dcm.action.export']}"
                                    id="cb11">
                    <af:fileDownloadActionListener contentType="application/vnd.ms-excel"
                                                   method="#{viewScope.BPCostBean.operation_export}"
                                                   filename="#{viewScope.BPCostBean.exportDataExcelName}"/>
                  </af:commandButton>
                </af:gridCell>
              </af:gridRow>
            </af:panelGridLayout>
          </af:panelWindow>
        </af:popup>
        <af:popup id="p1" binding="#{viewScope.BPCostBean.errorWindow}">
          <af:panelWindow id="pw1" title="#{viewBundle['dcm.import_error']}">
            <af:panelStretchLayout id="psl2" inlineStyle="width:800px;height:400px">
              <f:facet name="bottom"/>
              <f:facet name="center">
                <af:table value="#{bindings.ProPlanCostView.collectionModel}"
                          var="row" rows="#{bindings.ProPlanCostView.rangeSize}"
                          emptyText="#{bindings.ProPlanCostView.viewable ? 'No data to display.' : 'Access Denied.'}"
                          fetchSize="#{bindings.ProPlanCostView.rangeSize}"
                          rowBandingInterval="0"
                          selectedRowKeys="#{bindings.ProPlanCostView.collectionModel.selectedRow}"
                          selectionListener="#{bindings.ProPlanCostView.collectionModel.makeCurrent}"
                          rowSelection="single" id="t3"
                          columnStretching="column:c2">
                  <af:column sortProperty="#{bindings.ProPlanCostView.hints.Network.name}"
                             sortable="false"
                             headerText="#{bindings.ProPlanCostView.hints.Network.label}"
                             id="c10">
                    <af:outputText value="#{row.Network}" id="ot7"/>
                  </af:column>
                  <af:column sortProperty="#{bindings.ProPlanCostView.hints.WorkCode.name}"
                             sortable="false"
                             headerText="#{bindings.ProPlanCostView.hints.WorkCode.label}"
                             id="c8">
                    <af:outputText value="#{row.WorkCode}" id="ot9"/>
                  </af:column>
                  <af:column sortProperty="#{bindings.ProPlanCostView.hints.Work.name}"
                             sortable="false"
                             headerText="#{bindings.ProPlanCostView.hints.Work.label}"
                             id="c12">
                    <af:outputText value="#{row.Work}" id="ot12"/>
                  </af:column>
                  <af:column sortProperty="#{bindings.ProPlanCostView.hints.Term.name}"
                             sortable="false"
                             headerText="#{bindings.ProPlanCostView.hints.Term.label}"
                             id="c11">
                    <af:outputText value="#{row.Term}" id="ot15"/>
                  </af:column>
                  <af:column sortProperty="#{bindings.ProPlanCostView.hints.CostDetail.name}"
                             sortable="false"
                             headerText="#{bindings.ProPlanCostView.hints.CostDetail.label}"
                             id="c7">
                    <af:outputText value="#{row.CostDetail}" id="ot13"/>
                  </af:column>
                  <af:column sortProperty="#{bindings.ProPlanCostView.hints.Center.name}"
                             sortable="false"
                             headerText="#{bindings.ProPlanCostView.hints.Center.label}"
                             id="c9">
                    <af:outputText value="#{row.Center}" id="ot19"/>
                  </af:column>
                  <af:column sortProperty="#{bindings.ProPlanCostView.hints.WorkType.name}"
                             sortable="false"
                             headerText="#{bindings.ProPlanCostView.hints.WorkType.label}"
                             id="c5">
                    <af:outputText value="#{row.WorkType}" id="ot11"/>
                  </af:column>
                  <af:column sortProperty="#{bindings.ProPlanCostView.hints.BomCode.name}"
                             sortable="false"
                             headerText="#{bindings.ProPlanCostView.hints.BomCode.label}"
                             id="c4">
                    <af:outputText value="#{row.BomCode}" id="ot17"/>
                  </af:column>
                  <af:column sortProperty="#{bindings.ProPlanCostView.hints.Msg.name}"
                             sortable="false"
                             headerText="#{bindings.ProPlanCostView.hints.Msg.label}"
                             id="c2">
                    <af:outputText value="#{row.Msg}" id="ot8"/>
                  </af:column>
                  <af:column sortProperty="#{bindings.ProPlanCostView.hints.CreatedAt.name}"
                             sortable="false"
                             headerText="#{bindings.ProPlanCostView.hints.CreatedAt.label}"
                             id="c3">
                    <af:outputText value="#{row.CreatedAt}" id="ot16">
                      <af:convertDateTime pattern="#{bindings.ProPlanCostView.hints.CreatedAt.format}"/>
                    </af:outputText>
                  </af:column>
                  <af:column sortProperty="#{bindings.ProPlanCostView.hints.CreatedBy.name}"
                             sortable="false"
                             headerText="#{bindings.ProPlanCostView.hints.CreatedBy.label}"
                             id="c6">
                    <af:outputText value="#{row.CreatedBy}" id="ot18"/>
                  </af:column>
                </af:table>
              </f:facet>
              <f:facet name="start"/>
              <f:facet name="end"/>
              <f:facet name="top"/>
            </af:panelStretchLayout>
          </af:panelWindow>
        </af:popup>
        <af:popup id="p3" binding="#{viewScope.BPCostBean.dataImportWnd}">
          <af:panelWindow id="pw3"
                          title="#{viewBundle['dgpt.template.data_import']}">
            <af:panelGridLayout id="pgl6">
              <af:gridRow marginTop="5px" height="auto" id="gr3">
                <af:gridCell marginStart="5px" width="auto" id="gc2">
                  <af:outputText value="#{viewBundle['dcm.plz_select_import_file']}" id="ot14"/>
                </af:gridCell>
                <af:gridCell marginStart="5px" marginEnd="5px" width="auto"
                             id="gc1">
                  <af:inputFile id="if1" columns="15" simple="true"
                                binding="#{viewScope.BPCostBean.fileInput}"/>
                </af:gridCell>
              </af:gridRow>
              <af:gridRow marginTop="5px" marginBottom="5px" height="auto"
                          id="gr4">
                <af:gridCell marginStart="5px" width="auto" id="gc4"
                             halign="center" columnSpan="2">
                  <af:commandButton text="#{viewBundle['dms.dgpt.excel.import']}" id="cb6"
                                    actionListener="#{viewScope.BPCostBean.operation_import}"
                                    inlineStyle="margin-top:5px"/>
                </af:gridCell>
              </af:gridRow>
            </af:panelGridLayout>
          </af:panelWindow>
        </af:popup>
        <af:popup id="p4" binding="#{viewScope.BPCostBean.adminBlockPop}">
          <af:panelWindow id="pw4"
                          title="#{viewBundle['dms.dgpt.block_status.select']}">
            <af:panelCollection id="pc2" inlineStyle="width:800px;height:400px">
              <f:facet name="menus"/>
              <f:facet name="toolbar"/>
              <f:facet name="statusbar"/>
              <af:table value="#{bindings.adminBlockStatus.collectionModel}"
                        var="row" rows="#{bindings.adminBlockStatus.rangeSize}"
                        emptyText="#{bindings.adminBlockStatus.viewable ? 'No data to display.' : 'Access Denied.'}"
                        fetchSize="#{bindings.adminBlockStatus.rangeSize}"
                        rowBandingInterval="0"
                        filterModel="#{bindings.adminBlockStatusQuery.queryDescriptor}"
                        queryListener="#{bindings.adminBlockStatusQuery.processQuery}"
                        filterVisible="false" varStatus="vs"
                        selectedRowKeys="#{bindings.adminBlockStatus.collectionModel.selectedRow}"
                        selectionListener="#{bindings.adminBlockStatus.collectionModel.makeCurrent}"
                        rowSelection="single" id="t4"
                        columnStretching="column:c15">
                <af:column sortProperty="#{bindings.adminBlockStatus.hints.Meaning.name}"
                           filterable="true" sortable="false"
                           headerText="#{bindings.adminBlockStatus.hints.Meaning.label}"
                           id="c14">
                  <af:outputText value="#{row.Meaning}" id="ot22"/>
                </af:column>
                <af:column sortProperty="#{bindings.adminBlockStatus.hints.ProjectName.name}"
                           filterable="true" sortable="false"
                           headerText="#{bindings.adminBlockStatus.hints.ProjectName.label}"
                           id="c15">
                  <af:outputText value="#{row.ProjectName}" id="ot21"/>
                </af:column>
                <af:column sortProperty="#{bindings.adminBlockStatus.hints.Version.name}"
                           filterable="true" sortable="false"
                           headerText="#{bindings.adminBlockStatus.hints.Version.label}"
                           id="c13">
                  <af:outputText value="#{row.Version}" id="ot20"/>
                </af:column>
                <af:column sortProperty="#{bindings.adminBlockStatus.hints.IsBlock.name}"
                           filterable="true" sortable="false"
                           headerText="#{bindings.adminBlockStatus.hints.IsBlock.label}"
                           id="c16">
                  <af:outputText value="#{row.IsBlock}" id="ot23"/>
                </af:column>
              </af:table>
            </af:panelCollection>
          </af:panelWindow>
        </af:popup>
        <af:popup id="p5" binding="#{viewScope.BPCostBean.statusWindow}">
          <af:panelWindow id="pw5"
                          title="#{viewBundle['dms.dgpt.block_status.select']}">
            <af:panelCollection id="pc3" inlineStyle="width:800px;height:400px">
              <f:facet name="menus"/>
              <f:facet name="toolbar"/>
              <f:facet name="statusbar"/>
              <af:table value="#{bindings.PTBlockStatus.collectionModel}"
                        var="row" rows="#{bindings.PTBlockStatus.rangeSize}"
                        emptyText="#{bindings.PTBlockStatus.viewable ? 'No data to display.' : 'Access Denied.'}"
                        fetchSize="#{bindings.PTBlockStatus.rangeSize}"
                        rowBandingInterval="0"
                        filterModel="#{bindings.PTBlockStatusQuery.queryDescriptor}"
                        queryListener="#{bindings.PTBlockStatusQuery.processQuery}"
                        filterVisible="false" varStatus="vs"
                        selectedRowKeys="#{bindings.PTBlockStatus.collectionModel.selectedRow}"
                        selectionListener="#{bindings.PTBlockStatus.collectionModel.makeCurrent}"
                        rowSelection="single" id="t5"
                        columnStretching="column:c18">
                <af:column sortProperty="#{bindings.PTBlockStatus.hints.Meaning.name}"
                           filterable="true" sortable="false"
                           headerText="#{bindings.PTBlockStatus.hints.Meaning.label}"
                           id="c19">
                  <af:outputText value="#{row.Meaning}" id="ot26"/>
                </af:column>
                <af:column sortProperty="#{bindings.PTBlockStatus.hints.ProjectName.name}"
                           filterable="true" sortable="false"
                           headerText="#{bindings.PTBlockStatus.hints.ProjectName.label}"
                           id="c18">
                  <af:outputText value="#{row.ProjectName}" id="ot25"/>
                </af:column>
                <af:column sortProperty="#{bindings.PTBlockStatus.hints.Version.name}"
                           filterable="true" sortable="false"
                           headerText="#{bindings.PTBlockStatus.hints.Version.label}"
                           id="c17">
                  <af:outputText value="#{row.Version}" id="ot27"/>
                </af:column>
                <af:column sortProperty="#{bindings.PTBlockStatus.hints.IsBlock.name}"
                           filterable="true" sortable="false"
                           headerText="#{bindings.PTBlockStatus.hints.IsBlock.label}"
                           id="c20">
                  <af:outputText value="#{row.isBlock}" id="ot24"/>
                </af:column>
              </af:table>
            </af:panelCollection>
          </af:panelWindow>
        </af:popup>
      </af:panelGroupLayout>
    </f:facet>
    <f:facet name="center">
      <af:panelCollection id="pc1">
        <f:facet name="menus"/>
        <f:facet name="toolbar">
          <af:toolbar id="t1">
          <af:group id="grp1">
            <af:commandButton text="#{viewBundle['dms.common.save']}" id="cb1"
                              actionListener="#{viewScope.BPCostBean.operation_save}"/>
            <af:commandButton text="#{viewBundle['dms.common.cancel']}" id="cb2"
                              actionListener="#{viewScope.BPCostBean.operation_reset}"/>
        </af:group>
        <af:group id="g1">
              <af:commandButton text="#{viewBundle['dms.dgpt.excel.import']}" id="cb8"
                                disabled="#{viewScope.BPCostBean.isBlock or not viewScope.BPCostBean.isEDITABLE}"
                                partialTriggers="cb3">
                <af:showPopupBehavior popupId="::p3"/>
              </af:commandButton>
              <af:commandButton text="#{viewBundle['dcm.action.export']}" id="cb7">
                <af:showPopupBehavior popupId="::p2"/>
              </af:commandButton>
              <af:commandButton text="#{viewBundle['dms.dgpt.block']}" id="cb3"
                                actionListener="#{viewScope.BPCostBean.beBlocked}"
                                     disabled="#{viewScope.BPCostBean.isBlock}"
                                partialTriggers="::soc1 ::iclov2 ::soc3"/>
              <af:commandButton text="#{viewBundle['dms.dgpt.block.status']}" id="cb9"
                                actionListener="#{viewScope.BPCostBean.blockStatusPop}"/>
              <af:commandButton text="#{viewBundle['dms.dgpt.fblock']}" id="cb5"
                                rendered="#{viewScope.BPCostBean.isManager}"
                                actionListener="#{viewScope.BPCostBean.outBlock}"
                                disabled="#{not viewScope.BPCostBean.isBlock}"
                                partialTriggers="::soc1 ::iclov2 ::soc3"/>
              <af:commandButton text="#{viewBundle['dcm.import_error']}" id="cb4"
                                actionListener="#{viewScope.BPCostBean.errorPop}"/>
            </af:group>
          </af:toolbar>
        </f:facet>
        <f:facet name="statusbar"/>
        <af:table var="row" rowBandingInterval="0" id="t2"
                  value="#{viewScope.BPCostBean.dataModel}"
                  selectionListener="#{viewScope.BPCostBean.rowSelectionListener}"
                  selectedRowKeys="#{viewScope.BPCostBean.dataModel.selectedRows}"
                  rowSelection="multiple" editingMode="clickToEdit"
                  emptyText="#{viewBundle['dms.common.nodata']}"
                  partialTriggers=":::soc1 :::iclov2 :::soc3 ::cb3">
            <af:forEach items="#{viewScope.BPCostBean.dataModel.pcColsDef}"
                        var="attr" varStatus="vs">
                  <af:column sortable="false" headerText="#{attr.columnLable}" id="c1"
                            inlineStyle="#{'UPDATE' eq row['OPERATION'] ? 'background-color:GREEN;' : ''}
                                    #{'CREATE' eq row['OPERATION'] ? 'background-color:RED;' : ''}
                                    #{'DELETE' eq row['OPERATION'] ? 'background-color:YELLOW;' : ''}"
                             rendered="#{attr.dbTableCol ne &quot;ROW_ID&quot;}">
                    <af:inputText value="#{row[attr.dbTableCol]}" id="ot6"
                                  readOnly="#{attr.isReadonly eq 'false' ? 
                                  viewScope.BPCostBean.isBlock or not viewScope.BPCostBean.isEDITABLE: attr.isReadonly}"
                                    valueChangeListener="#{viewScope.BPCostBean.valueChangeLinstener}"/>
                  </af:column>
          </af:forEach>
        </af:table>
      </af:panelCollection>
    </f:facet>
    <f:facet name="start"/>
    <f:facet name="end"/>
    <f:facet name="top">
      <af:panelGroupLayout id="pgl1" layout="vertical">
        <af:panelGroupLayout id="pgl2" layout="horizontal">
        <af:selectOneChoice 
                              label="年" autoSubmit="true"
                              id="soc1"
                              value="#{viewScope.BPCostBean.year}"
                            valueChangeListener="#{viewScope.BPCostBean.yearChange}">
            <f:selectItems value="#{viewScope.BPCostBean.yearList}" id="si1"/>
          </af:selectOneChoice>
          <af:panelLabelAndMessage label="实体" 
                                   id="plam1" >
            <af:outputText  id="ot1" partialTriggers="iclov2 soc1 soc3" value="#{viewScope.BPCostBean.entity}"/>
          </af:panelLabelAndMessage>
          <af:panelLabelAndMessage label="产品线"
                                   id="plam2">
            <af:outputText  id="ot2" partialTriggers="iclov2 soc1 soc3" value="#{viewScope.BPCostBean.PLine}"/>
          </af:panelLabelAndMessage>
          <!--af:selectOneChoice 
                              label="项目名称" autoSubmit="true"
                              id="iclov2"
                              value="#{viewScope.BPCostBean.pname}"
                              valueChangeListener="#{viewScope.BPCostBean.projectChange}">
            <f:selectItems id="si2" value="#{viewScope.BPCostBean.pnameList}"/>
          </af:selectOneChoice-->
          <af:inputComboboxListOfValues label="项目名称" inlineStyle="margin-right:5px"
                                                value="#{viewScope.BPCostBean.pname}"
                                                autoSubmit="true" clientComponent="true"
                                                validator="#{viewScope.BPCostBean.proLov.listOfValuesModel.validate}"
                                                model="#{viewScope.BPCostBean.proLov.listOfValuesModel}"
                                                id="iclov2" columns="20"
                                                valueChangeListener="#{viewScope.BPCostBean.projectChange}"
                                              usage="auto">
                    <af:autoSuggestBehavior suggestedItems="#{viewScope.BPCostBean.proLov.listOfValuesModel.suggest}"/>
                  </af:inputComboboxListOfValues>
        </af:panelGroupLayout>
        <af:panelGroupLayout id="pgl3" layout="horizontal">
            <af:selectOneChoice 
                              label="版本" autoSubmit="true"
                              id="soc3"
                              value="#{viewScope.BPCostBean.version}"
                                valueChangeListener="#{viewScope.BPCostBean.versionChange}"
                                partialTriggers="iclov2 soc1">
            <f:selectItems  id="si3"
                           value="#{viewScope.BPCostBean.versionList}"/>
          </af:selectOneChoice>
          <af:panelLabelAndMessage label="项目类型"
                                   id="plam3" >
            <af:outputText id="ot3" partialTriggers="iclov2 soc1 soc3" value="#{viewScope.BPCostBean.proType}"/>
          </af:panelLabelAndMessage>
          <af:panelLabelAndMessage label="行业线" 
                                   id="plam4">
            <af:outputText partialTriggers="iclov2"
                           id="ot4" value="#{viewScope.BPCostBean.HLine}"/>
          </af:panelLabelAndMessage>
          <af:panelLabelAndMessage label="业务线" 
                                   id="plam5">
            <af:outputText partialTriggers="iclov2 soc1 soc3"
                           id="ot5" value="#{viewScope.BPCostBean.YLine}"/>
          </af:panelLabelAndMessage>
        </af:panelGroupLayout>
      </af:panelGroupLayout>
    </f:facet>
  </af:panelStretchLayout>
</jsp:root>
